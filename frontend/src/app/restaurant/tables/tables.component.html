<!-- Header -->
<header style="background:linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);color:#c4a75b;padding:20px 32px;box-shadow:0 2px 8px rgba(0,0,0,0.2);">
  <div style="display:flex;align-items:center;justify-content:space-between;">
    <h1 style="margin:0;font-size:24px;font-weight:700;">ðŸª‘ Table Management</h1>
    <div class="header-actions">
      <select class="form-select" [(ngModel)]="selectedFloorId" (change)="filterByFloor(selectedFloorId || '')">
        <option value="">All Floors</option>
        <option *ngFor="let floor of floors" [value]="floor.id">{{ floor.name }}</option>
      </select>
      <button (click)="openCreateModal()" style="background:#c4a75b;color:#1a1a1a;border:none;padding:12px 24px;border-radius:8px;font-weight:600;cursor:pointer;font-size:14px;">
        âž• Add Table
      </button>
    </div>
  </div>
</header>

<div class="tables-container">
  <div class="loading-spinner" *ngIf="loading && tables.length === 0">
    <i class="fa fa-spinner fa-spin"></i> Loading tables...
  </div>

  <div class="tables-by-floor" *ngIf="!loading || tables.length > 0">
    <div *ngFor="let floor of getFilteredTablesByFloor() | keyvalue" class="floor-section">
      <h3 class="floor-title">
        <i class="fa fa-building"></i> {{ floor.key }}
        <span class="table-count">({{ floor.value.length }} tables)</span>
      </h3>

      <div class="tables-grid">
        <div class="table-card" *ngFor="let table of floor.value"
             [class.table-available]="table.status === 'AVAILABLE'"
             [class.table-occupied]="table.status === 'OCCUPIED'"
             [class.table-reserved]="table.status === 'RESERVED'"
             [class.table-cleaning]="table.status === 'CLEANING'">

          <div class="table-header">
            <div class="table-info">
              <h4>{{ table.tableNumber }}</h4>
              <span class="badge" [ngClass]="getStatusBadgeClass(table.status)">
                <i class="fa" [ngClass]="getStatusIcon(table.status)"></i>
                {{ table.status }}
              </span>
            </div>
            <div class="table-actions">
              <button class="btn-icon" (click)="openEditModal(table)" title="Edit">
                <i class="fa fa-edit"></i>
              </button>
              <button class="btn-icon btn-danger" (click)="deleteTable(table)" title="Delete">
                <i class="fa fa-trash"></i>
              </button>
            </div>
          </div>

          <div class="table-details">
            <div class="detail-item">
              <i class="fa fa-users"></i>
              <span>{{ table.capacity }} seats</span>
            </div>
            <div class="detail-item" *ngIf="table.shape">
              <i class="fa fa-shapes"></i>
              <span>{{ table.shape }}</span>
            </div>
          </div>

          <div class="table-status-actions">
            <button
              class="btn-status"
              *ngFor="let status of statuses"
              [class.active]="table.status === status"
              (click)="updateTableStatus(table, status)"
              [title]="'Set as ' + status">
              <i class="fa" [ngClass]="getStatusIcon(status)"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="tables.length === 0 && !loading">
      <i class="fa fa-table fa-3x"></i>
      <h3>No Tables Found</h3>
      <p *ngIf="selectedFloorId">No tables on this floor yet</p>
      <p *ngIf="!selectedFloorId">Create your first table to start managing seating</p>
      <button class="btn btn-primary" (click)="openCreateModal()">
        <i class="fa fa-plus"></i> Add First Table
      </button>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ editingTable ? 'Edit Table' : 'Add New Table' }}</h2>
        <button class="btn-close" (click)="closeModal()">&times;</button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label>Floor *</label>
          <select class="form-control" [(ngModel)]="tableForm.floorId" required>
            <option value="">Select Floor</option>
            <option *ngFor="let floor of floors" [value]="floor.id">{{ floor.name }}</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Table Number *</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="tableForm.tableNumber"
              placeholder="e.g., T1, A-5"
              required>
          </div>

          <div class="form-group">
            <label>Capacity *</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="tableForm.capacity"
              min="1"
              max="20"
              required>
          </div>
        </div>

        <div class="form-group">
          <label>Shape</label>
          <select class="form-control" [(ngModel)]="tableForm.shape">
            <option *ngFor="let shape of shapes" [value]="shape">{{ shape }}</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Position X</label>
            <input
              type="number"
              class="form-control"
              [ngModel]="tableForm.positionX"
              (ngModelChange)="tableForm.positionX = $event"
              placeholder="0">
            <small class="form-text">For floor plan layout</small>
          </div>

          <div class="form-group">
            <label>Position Y</label>
            <input
              type="number"
              class="form-control"
              [ngModel]="tableForm.positionY"
              (ngModelChange)="tableForm.positionY = $event"
              placeholder="0">
            <small class="form-text">For floor plan layout</small>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
        <button class="btn btn-primary" (click)="saveTable()" [disabled]="loading">
          <i class="fa fa-spinner fa-spin" *ngIf="loading"></i>
          {{ loading ? 'Saving...' : (editingTable ? 'Update' : 'Create') }}
        </button>
      </div>
    </div>
  </div>
</div>
